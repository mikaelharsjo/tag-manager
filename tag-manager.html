<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-shadow/paper-shadow.html">
<link rel="import" href="../core-input/core-input.html">
<link rel="import" href="../typeahead-input/typeahead-input.html">

<!--
Element providing solution to no problem in particular.

##### Example

    <tag-manager></tag-manager>

@element tag-manager
@blurb Element for tagging.
@status alpha
@homepage http://mikaelharsjo.github.io/tag-manager
-->
<polymer-element name="tag-manager" attributes="notitle author tags suggestions">

  <template>

    <link rel="stylesheet" href="tag-manager.css">

    <template repeat="{{tag in tags}}">
        <paper-shadow z="1">{{tag}}</paper-shadow>
    </template>

    <typeahead-input hint="add tag" id="typeahead" on-blur="{{onBlur}}" on-keypress="{{keypressHandler}}"></typeahead-input>
    <div class="values">
      <template if="{{preview}}" repeat="{{data}}">
        <div selected="{{selected}}">
          <template repeat="{{values}}">
            {{}}<br>
          </template>
        </div>
      </template>
    </div>

  </template>

  <script>

    Polymer({
      /**
      * The `tags` attribute sets the initial tags
      *
      * @attribute tags
      * @type array
      * @default []
      */
      tags: [],

      /**
      * The `suggestions` attribute sets suggestions for the typeahead
      *
      * @attribute suggestions
      * @type array
      * @default []
      */
      suggestions: [],

      ready: function() {
        this.$.typeahead.values = this.suggestions;
      },

      keypressHandler: function(event, detail, sender) {
        if (event.keyCode === 13) {
          this.addCurrentTag();
        }
      },

      onBlur: function() {
        this.addCurrentTag();
      },

      addCurrentTag: function () {
        this.tags.push(this.$.typeahead.input);
        this.$.typeahead.$.input.value = '';
        this.$.typeahead.$.hint.value = 'add tag';
      }

    });

  </script>

</polymer-element>
